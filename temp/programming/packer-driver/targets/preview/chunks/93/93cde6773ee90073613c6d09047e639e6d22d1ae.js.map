{"version":3,"sources":["file:///D:/Work/job/CardsGame/assets/Classes/models/RuntimeCardData.ts"],"names":["RuntimeCardData","constructor","config","id","isFaceUp","isLocked","currentArea","position","x","y","zIndex","stateHistory","generateId","Position","Date","now","Math","random","toString","substr","saveState","state","push","restoreState","length","lastState","pop","clearHistory","getHistoryCount"],"mappings":";;;8BAMaA,e;;;;;;;;;;;;;;;;;;;;AANb;AACA;AACA;AACA;;;iCAGaA,e,GAAN,MAAMA,eAAN,CAAsB;AAiBzBC,QAAAA,WAAW,CAACC,MAAD,EAAqBC,EAArB,EAAkC;AAhB7C;AAgB6C,eAf7BA,EAe6B;AAb7C;AAa6C,eAZ7BD,MAY6B;AAV7C;AAU6C,eATtCE,QASsC,GATlB,KASkB;AATJ;AASI,eARtCC,QAQsC,GARlB,KAQkB;AARJ;AAQI,eAPtCC,WAOsC,GAPhB,EAOgB;AAPJ;AAOI,eANtCC,QAMsC,GAND;AAAEC,YAAAA,CAAC,EAAE,CAAL;AAAQC,YAAAA,CAAC,EAAE;AAAX,WAMC;AANgB;AAMhB,eALtCC,MAKsC,GALrB,CAKqB;AALJ;AAEzC;AAG6C,eAFrCC,YAEqC,GAFT,EAES;AACzC,eAAKT,MAAL,GAAcA,MAAd;AACA,eAAKC,EAAL,GAAUA,EAAE,IAAI,KAAKS,UAAL,EAAhB;AACA,eAAKL,QAAL,gBAAqBL,MAAM,CAACW,QAA5B;AACH;AAED;AACJ;AACA;;;AACYD,QAAAA,UAAU,GAAW;AACzB,2BAAeE,IAAI,CAACC,GAAL,EAAf,SAA6BC,IAAI,CAACC,MAAL,GAAcC,QAAd,CAAuB,EAAvB,EAA2BC,MAA3B,CAAkC,CAAlC,EAAqC,CAArC,CAA7B;AACH;AAED;AACJ;AACA;;;AACWC,QAAAA,SAAS,GAAS;AACrB,cAAMC,KAAgB,GAAG;AACrBjB,YAAAA,QAAQ,EAAE,KAAKA,QADM;AAErBC,YAAAA,QAAQ,EAAE,KAAKA,QAFM;AAGrBC,YAAAA,WAAW,EAAE,KAAKA,WAHG;AAIrBC,YAAAA,QAAQ,eAAO,KAAKA,QAAZ,CAJa;AAKrBG,YAAAA,MAAM,EAAE,KAAKA;AALQ,WAAzB;AAOA,eAAKC,YAAL,CAAkBW,IAAlB,CAAuBD,KAAvB;AACH;AAED;AACJ;AACA;AACA;;;AACWE,QAAAA,YAAY,GAAY;AAC3B,cAAI,KAAKZ,YAAL,CAAkBa,MAAlB,KAA6B,CAAjC,EAAoC,OAAO,KAAP;AAEpC,cAAMC,SAAS,GAAG,KAAKd,YAAL,CAAkBe,GAAlB,EAAlB;;AACA,cAAID,SAAJ,EAAe;AACX,iBAAKrB,QAAL,GAAgBqB,SAAS,CAACrB,QAA1B;AACA,iBAAKC,QAAL,GAAgBoB,SAAS,CAACpB,QAA1B;AACA,iBAAKC,WAAL,GAAmBmB,SAAS,CAACnB,WAA7B;AACA,iBAAKC,QAAL,gBAAqBkB,SAAS,CAAClB,QAA/B;AACA,iBAAKG,MAAL,GAAce,SAAS,CAACf,MAAxB;AACA,mBAAO,IAAP;AACH;;AACD,iBAAO,KAAP;AACH;AAED;AACJ;AACA;;;AACWiB,QAAAA,YAAY,GAAS;AACxB,eAAKhB,YAAL,GAAoB,EAApB;AACH;AAED;AACJ;AACA;;;AACWiB,QAAAA,eAAe,GAAW;AAC7B,iBAAO,KAAKjB,YAAL,CAAkBa,MAAzB;AACH;;AA3EwB,O;AA8E7B;AACA;AACA","sourcesContent":["/**\r\n * 运行时卡牌数据模型\r\n * 用于管理卡牌在游戏过程中的动态状态\r\n */\r\nimport { CardConfig } from './CardData';\r\n\r\nexport class RuntimeCardData {\r\n    // 卡牌唯一ID\r\n    public readonly id: string;\r\n\r\n    // 静态配置数据\r\n    public readonly config: CardConfig;\r\n\r\n    // 动态状态数据\r\n    public isFaceUp: boolean = false;        // 是否正面朝上\r\n    public isLocked: boolean = false;        // 是否被锁定（不可移动）\r\n    public currentArea: string = '';         // 当前所在区域（table/hand等）\r\n    public position: { x: number; y: number } = { x: 0, y: 0 };  // 当前位置\r\n    public zIndex: number = 0;               // 层级\r\n\r\n    // 历史状态（用于回退）\r\n    private stateHistory: CardState[] = [];\r\n\r\n    constructor(config: CardConfig, id?: string) {\r\n        this.config = config;\r\n        this.id = id || this.generateId();\r\n        this.position = { ...config.Position };\r\n    }\r\n\r\n    /**\r\n     * 生成唯一ID\r\n     */\r\n    private generateId(): string {\r\n        return `card_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n    }\r\n\r\n    /**\r\n     * 保存当前状态到历史记录\r\n     */\r\n    public saveState(): void {\r\n        const state: CardState = {\r\n            isFaceUp: this.isFaceUp,\r\n            isLocked: this.isLocked,\r\n            currentArea: this.currentArea,\r\n            position: { ...this.position },\r\n            zIndex: this.zIndex\r\n        };\r\n        this.stateHistory.push(state);\r\n    }\r\n\r\n    /**\r\n     * 回退到上一个状态\r\n     * @returns 是否成功回退\r\n     */\r\n    public restoreState(): boolean {\r\n        if (this.stateHistory.length === 0) return false;\r\n\r\n        const lastState = this.stateHistory.pop();\r\n        if (lastState) {\r\n            this.isFaceUp = lastState.isFaceUp;\r\n            this.isLocked = lastState.isLocked;\r\n            this.currentArea = lastState.currentArea;\r\n            this.position = { ...lastState.position };\r\n            this.zIndex = lastState.zIndex;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 清空历史记录\r\n     */\r\n    public clearHistory(): void {\r\n        this.stateHistory = [];\r\n    }\r\n\r\n    /**\r\n     * 获取历史记录数量\r\n     */\r\n    public getHistoryCount(): number {\r\n        return this.stateHistory.length;\r\n    }\r\n}\r\n\r\n/**\r\n * 卡牌状态接口\r\n */\r\nexport interface CardState {\r\n    isFaceUp: boolean;\r\n    isLocked: boolean;\r\n    currentArea: string;\r\n    position: { x: number; y: number };\r\n    zIndex: number;\r\n}\r\n"]}