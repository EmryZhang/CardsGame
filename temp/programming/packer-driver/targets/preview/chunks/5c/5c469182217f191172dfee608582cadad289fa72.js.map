{"version":3,"sources":["file:///D:/Work/job/CardsGame/assets/Classes/views/CardView.ts"],"names":["_decorator","Component","Node","Sprite","tween","Vec3","ccclass","property","CardView","_cardData","_cardIndex","_area","_onClickCallback","onLoad","console","log","node","name","on","EventType","TOUCH_START","onTouchStart","TOUCH_END","onTouchEnd","TOUCH_CANCEL","onTouchCancel","init","cardData","index","area","setClickCallback","callback","event","to","scale","start","getCardData","getCardIndex","getCardArea","onDestroy","off"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventTouch, Node, Sprite, tween, Vec3 } from 'cc';\r\nimport { CardModel } from '../models/CardModel';\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('CardView')\r\nexport default class CardView extends Component {\r\n    // 引用卡牌的子节点\r\n    @property(Sprite)\r\n    bgSprite: Sprite = null;\r\n    \r\n    @property(Sprite)\r\n    bigNumSprite: Sprite = null;\r\n    \r\n    @property(Sprite)\r\n    smallNumSprite: Sprite = null;\r\n    \r\n    @property(Sprite)\r\n    suitSprite: Sprite = null;\r\n    \r\n    // 卡牌数据\r\n    private _cardData: CardModel = null;\r\n    private _cardIndex: number = 0;\r\n    private _area: string = ''; // 'table' 或 'hand'\r\n    \r\n    // 点击回调\r\n    private _onClickCallback: (cardView: CardView) => void = null;\r\n    \r\n    onLoad() {\r\n        console.log('CardView onLoad, 节点名称:', this.node.name);\r\n\r\n        // 确保节点可以接收触摸事件\r\n        this.node.on(Node.EventType.TOUCH_START, this.onTouchStart, this);\r\n        this.node.on(Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        this.node.on(Node.EventType.TOUCH_CANCEL, this.onTouchCancel, this);\r\n\r\n        console.log('CardView 触摸事件监听已设置');\r\n    }\r\n    \r\n    // 初始化卡牌视图\r\n    init(cardData: CardModel, index: number, area: string): void {\r\n        this._cardData = cardData;\r\n        this._cardIndex = index;\r\n        this._area = area;\r\n        console.log('CardView init, area:', area, 'index:', index);\r\n    }\r\n    \r\n    // 设置点击回调\r\n    setClickCallback(callback: (cardView: CardView) => void): void {\r\n        this._onClickCallback = callback;\r\n    }\r\n    \r\n    // 触摸开始（添加点击效果）\r\n    private onTouchStart(event: EventTouch): void {\r\n        console.log('CardView onTouchStart, 节点:', this.node.name);\r\n        tween(this.node)\r\n            .to(0.1, { scale: new Vec3(0.95, 0.95, 1) })\r\n            .start();\r\n    }\r\n    \r\n    // 触摸结束（触发点击事件）\r\n    private onTouchEnd(event: EventTouch): void {\r\n        // 恢复大小\r\n        tween(this.node)\r\n            .to(0.1, { scale: new Vec3(1, 1, 1) })\r\n            .start();\r\n        \r\n        // 触发点击回调\r\n        if (this._onClickCallback) {\r\n            this._onClickCallback(this);\r\n        }\r\n    }\r\n    \r\n    // 触摸取消（恢复状态）\r\n    private onTouchCancel(event: EventTouch): void {\r\n        tween(this.node)\r\n            .to(0.1, { scale: new Vec3(1, 1, 1) })\r\n            .start();\r\n    }\r\n    \r\n    // 获取卡牌数据\r\n    getCardData(): CardModel {\r\n        return this._cardData;\r\n    }\r\n    \r\n    // 获取卡牌索引\r\n    getCardIndex(): number {\r\n        return this._cardIndex;\r\n    }\r\n    \r\n    // 获取卡牌区域\r\n    getCardArea(): string {\r\n        return this._area;\r\n    }\r\n    \r\n    onDestroy() {\r\n        // 清理事件监听\r\n        this.node.off(Node.EventType.TOUCH_START, this.onTouchStart, this);\r\n        this.node.off(Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n        this.node.off(Node.EventType.TOUCH_CANCEL, this.onTouchCancel, this);\r\n    }\r\n}\r\n"]}