{"version":3,"sources":["file:///D:/Work/job/CardsGame/assets/Classes/configs/GameConfig.ts"],"names":["GameConfig","JsonAsset","resources","DEFAULT_LAYOUT_CONFIG","_layoutConfig","instance","_instance","initialize","console","log","success","loadLayoutConfig","Promise","resolve","load","err","asset","warn","json","layoutConfig"],"mappings":";;;4HAGaA,U;;;;;;;;;;;;;;;;;;;;;;;AAHJC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,S,OAAAA,S;;AACXC,MAAAA,qB,iBAAAA,qB;;;;;;;;;4BAEIH,U,GAAN,MAAMA,UAAN,CAAiB;AAAA;AAAA,eAEZI,aAFY,GAEmB,IAFnB;AAAA;;AAIM,mBAARC,QAAQ,GAAe;AACrC,cAAI,CAAC,KAAKC,SAAV,EAAqB;AACjB,iBAAKA,SAAL,GAAiB,IAAIN,UAAJ,EAAjB;AACH;;AACD,iBAAO,KAAKM,SAAZ;AACH;;AAEYC,QAAAA,UAAU,GAAqB;AAAA;;AAAA;AACxC,gBAAI,KAAI,CAACH,aAAT,EAAwB,OAAO,IAAP,CADgB,CACH;;AAErCI,YAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACA,gBAAMC,OAAO,SAAS,KAAI,CAACC,gBAAL,EAAtB;AACA,mBAAOD,OAAP;AALwC;AAM3C;;AAEaC,QAAAA,gBAAgB,GAAqB;AAAA;;AAAA;AAC/C,mBAAO,IAAIC,OAAJ,CAAaC,OAAD,IAAa;AAC5BX,cAAAA,SAAS,CAACY,IAAV,CAAe,sBAAf,EAAuCb,SAAvC,EAAkD,CAACc,GAAD,EAAMC,KAAN,KAAgB;AAC9D,oBAAID,GAAJ,EAAS;AACLP,kBAAAA,OAAO,CAACS,IAAR,CAAa,qBAAb,EAAoCF,GAApC,EADK,CAEL;;AACA,kBAAA,MAAI,CAACX,aAAL;AAAA;AAAA;AACAS,kBAAAA,OAAO,CAAC,KAAD,CAAP;AACH,iBALD,MAKO;AACHL,kBAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACA,kBAAA,MAAI,CAACL,aAAL,GAAqBY,KAAK,CAACE,IAA3B;AACAL,kBAAAA,OAAO,CAAC,IAAD,CAAP;AACH;AACJ,eAXD;AAYH,aAbM,CAAP;AAD+C;AAelD;;AAEsB,YAAZM,YAAY,GAAkB;AACrC;AACA,iBAAO,KAAKf,aAAL;AAAA;AAAA,6DAAP;AACH;;AAvCmB,O;;AAAXJ,MAAAA,U,CACMM,S,GAAwB,I","sourcesContent":["import { JsonAsset, resources } from 'cc';\r\nimport { DEFAULT_LAYOUT_CONFIG, ILayoutConfig } from '../models/LayoutConfig';\r\n\r\nexport class GameConfig {\r\n    private static _instance: GameConfig = null;\r\n    private _layoutConfig: ILayoutConfig = null;\r\n    \r\n    public static get instance(): GameConfig {\r\n        if (!this._instance) {\r\n            this._instance = new GameConfig();\r\n        }\r\n        return this._instance;\r\n    }\r\n    \r\n    public async initialize(): Promise<boolean> {\r\n        if (this._layoutConfig) return true; // 避免重复加载\r\n        \r\n        console.log('⚙️ 初始化游戏配置...');\r\n        const success = await this.loadLayoutConfig();\r\n        return success;\r\n    }\r\n    \r\n    private async loadLayoutConfig(): Promise<boolean> {\r\n        return new Promise((resolve) => {\r\n            resources.load('configs/LayoutConfig', JsonAsset, (err, asset) => {\r\n                if (err) {\r\n                    console.warn('⚠️ 加载JSON失败，使用默认配置:', err);\r\n                    // 关键：加载失败时，赋值默认配置\r\n                    this._layoutConfig = DEFAULT_LAYOUT_CONFIG;\r\n                    resolve(false);\r\n                } else {\r\n                    console.log('✅ 布局配置加载成功');\r\n                    this._layoutConfig = asset.json as ILayoutConfig;\r\n                    resolve(true);\r\n                }\r\n            });\r\n        });\r\n    }\r\n    \r\n    public get layoutConfig(): ILayoutConfig {\r\n        // 如果还没初始化，直接返回默认值，防止报错\r\n        return this._layoutConfig || DEFAULT_LAYOUT_CONFIG;\r\n    }\r\n}\r\n"]}