{"version":3,"sources":["file:///D:/Work/job/CardsGame/assets/resources/configs/GameConfig.ts"],"names":["GameConfig","JsonAsset","resources","DEFAULT_LAYOUT_CONFIG","designWidth","designHeight","cardWidth","cardHeight","tableLayout","centerX","centerY","scale","handLayout","mode","stackStartX","stackStartY","stackSpacingX","separateCardX","separateCardY","_layoutConfig","instance","_instance","initialize","console","log","success","loadLayoutConfig","Promise","resolve","load","err","asset","warn","json","layoutConfig"],"mappings":";;;wFAoDaA,U;;;;;;;;;AApDJC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,S,OAAAA,S;;;;;;;AAEpB;;;AA6BA;uCACaC,qB,GAAuC;AAChDC,QAAAA,WAAW,EAAE,IADmC;AAEhDC,QAAAA,YAAY,EAAE,IAFkC;AAGhDC,QAAAA,SAAS,EAAE,GAHqC;AAIhDC,QAAAA,UAAU,EAAE,GAJoC;AAKhDC,QAAAA,WAAW,EAAE;AACTC,UAAAA,OAAO,EAAE,CADA;AAETC,UAAAA,OAAO,EAAE,GAFA;AAGTC,UAAAA,KAAK,EAAE;AAHE,SALmC;AAUhDC,QAAAA,UAAU,EAAE;AACRC,UAAAA,IAAI,EAAE,qBADE;AAERC,UAAAA,WAAW,EAAE,CAAC,GAFN;AAGRC,UAAAA,WAAW,EAAE,GAHL;AAIRC,UAAAA,aAAa,EAAE,GAJP;AAKRC,UAAAA,aAAa,EAAE,GALP;AAMRC,UAAAA,aAAa,EAAE;AANP;AAVoC,O;;4BAoBvClB,U,GAAN,MAAMA,UAAN,CAAiB;AAAA;AAAA,eAEZmB,aAFY,GAEmB,IAFnB;AAAA;;AAIM,mBAARC,QAAQ,GAAe;AACrC,cAAI,CAAC,KAAKC,SAAV,EAAqB;AACjB,iBAAKA,SAAL,GAAiB,IAAIrB,UAAJ,EAAjB;AACH;;AACD,iBAAO,KAAKqB,SAAZ;AACH;;AAEsB,cAAVC,UAAU,GAAqB;AACxC,cAAI,KAAKH,aAAT,EAAwB,OAAO,IAAP,CADgB,CACH;;AAErCI,UAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACA,gBAAMC,OAAO,GAAG,MAAM,KAAKC,gBAAL,EAAtB;AACA,iBAAOD,OAAP;AACH;;AAE6B,cAAhBC,gBAAgB,GAAqB;AAC/C,iBAAO,IAAIC,OAAJ,CAAaC,OAAD,IAAa;AAC5B1B,YAAAA,SAAS,CAAC2B,IAAV,CAAe,sBAAf,EAAuC5B,SAAvC,EAAkD,CAAC6B,GAAD,EAAMC,KAAN,KAAgB;AAC9D,kBAAID,GAAJ,EAAS;AACLP,gBAAAA,OAAO,CAACS,IAAR,CAAa,qBAAb,EAAoCF,GAApC,EADK,CAEL;;AACA,qBAAKX,aAAL,GAAqBhB,qBAArB;AACAyB,gBAAAA,OAAO,CAAC,KAAD,CAAP;AACH,eALD,MAKO;AACHL,gBAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACA,qBAAKL,aAAL,GAAqBY,KAAK,CAACE,IAA3B;AACAL,gBAAAA,OAAO,CAAC,IAAD,CAAP;AACH;AACJ,aAXD;AAYH,WAbM,CAAP;AAcH;;AAEsB,YAAZM,YAAY,GAAkB;AACrC;AACA,iBAAO,KAAKf,aAAL,IAAsBhB,qBAA7B;AACH;;AAvCmB,O;;AAAXH,MAAAA,U,CACMqB,S,GAAwB,I","sourcesContent":["import { JsonAsset, resources } from 'cc';\r\n\r\n// 定义ILayoutConfig接口\r\nexport interface ILayoutConfig {\r\n    designWidth: number;\r\n    designHeight: number;\r\n    cardWidth: number;\r\n    cardHeight: number;\r\n\r\n    // 对应 JSON 中的 tableLayout: { \"centerX\": 0, \"centerY\": 300, \"scale\": 1.0 }\r\n    tableLayout: {\r\n        centerX: number;\r\n        centerY: number;\r\n        scale: number;\r\n    };\r\n\r\n    // 对应 JSON 中的 handLayout\r\n    handLayout: {\r\n        mode?: string;         // \"stack_last_separate\"\r\n\r\n        // 左侧堆叠组配置\r\n        stackStartX: number;   // JSON: \"stackStartX\"\r\n        stackStartY: number;   // JSON: \"stackStartY\"\r\n        stackSpacingX: number; // JSON: \"stackSpacingX\"\r\n\r\n        // 右侧单独卡牌配置\r\n        separateCardX: number; // JSON: \"separateCardX\"\r\n        separateCardY: number; // JSON: \"separateCardY\"\r\n    };\r\n}\r\n\r\n// 默认配置\r\nexport const DEFAULT_LAYOUT_CONFIG: ILayoutConfig = {\r\n    designWidth: 1080,\r\n    designHeight: 2080,\r\n    cardWidth: 300,\r\n    cardHeight: 180,\r\n    tableLayout: {\r\n        centerX: 0,\r\n        centerY: 300,\r\n        scale: 1.0\r\n    },\r\n    handLayout: {\r\n        mode: \"stack_last_separate\",\r\n        stackStartX: -200,\r\n        stackStartY: 750,\r\n        stackSpacingX: 100,\r\n        separateCardX: 350,\r\n        separateCardY: 750\r\n    }\r\n};\r\n\r\nexport class GameConfig {\r\n    private static _instance: GameConfig = null;\r\n    private _layoutConfig: ILayoutConfig = null;\r\n\r\n    public static get instance(): GameConfig {\r\n        if (!this._instance) {\r\n            this._instance = new GameConfig();\r\n        }\r\n        return this._instance;\r\n    }\r\n\r\n    public async initialize(): Promise<boolean> {\r\n        if (this._layoutConfig) return true; // 避免重复加载\r\n\r\n        console.log('⚙️ 初始化游戏配置...');\r\n        const success = await this.loadLayoutConfig();\r\n        return success;\r\n    }\r\n\r\n    private async loadLayoutConfig(): Promise<boolean> {\r\n        return new Promise((resolve) => {\r\n            resources.load('configs/LayoutConfig', JsonAsset, (err, asset) => {\r\n                if (err) {\r\n                    console.warn('⚠️ 加载JSON失败，使用默认配置:', err);\r\n                    // 关键：加载失败时，赋值默认配置\r\n                    this._layoutConfig = DEFAULT_LAYOUT_CONFIG;\r\n                    resolve(false);\r\n                } else {\r\n                    console.log('✅ 布局配置加载成功');\r\n                    this._layoutConfig = asset.json as ILayoutConfig;\r\n                    resolve(true);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    public get layoutConfig(): ILayoutConfig {\r\n        // 如果还没初始化，直接返回默认值，防止报错\r\n        return this._layoutConfig || DEFAULT_LAYOUT_CONFIG;\r\n    }\r\n}\r\n"]}